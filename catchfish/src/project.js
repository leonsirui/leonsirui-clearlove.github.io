__require=function e(t,i,n){function o(c,r){if(!i[c]){if(!t[c]){var h=c.split("/");if(h=h[h.length-1],!t[h]){var a="function"==typeof __require&&__require;if(!r&&a)return a(h,!0);if(s)return s(h,!0);throw new Error("Cannot find module '"+c+"'")}}var u=i[c]={exports:{}};t[c][0].call(u.exports,function(e){return o(t[c][1][e]||e)},u,u.exports,e,t,i,n)}return i[c].exports}for(var s="function"==typeof __require&&__require,c=0;c<n.length;c++)o(n[c]);return o}({LevelBG:[function(e,t,i){"use strict";cc._RF.push(t,"a4af6T2lA9O1LOKrI2NjsGZ","LevelBG"),cc.Class({extends:cc.Component,properties:{audioSource:{type:cc.AudioSource,default:null}},start:function(){this.loadBG()},loadBG:function(){var e=this.getComponent(cc.Sprite),t="GameMap/bg_"+(parseInt(4*Math.random())+1);cc.loader.loadRes(t,cc.SpriteFrame,function(t,i){e.spriteFrame=i})}}),cc._RF.pop()},{}],backMenu:[function(e,t,i){"use strict";cc._RF.push(t,"842datKlxVPZq8qWPmdahii","backMenu"),cc.Class({extends:cc.Component,properties:{},start:function(){},backMenu:function(){cc.director.loadScene("menu")}}),cc._RF.pop()},{}],bulletMgr:[function(e,t,i){"use strict";cc._RF.push(t,"42476FiTXBIc44Crbthr2QL","bulletMgr"),cc.Class({extends:cc.Component,properties:{bulletAngle:0,bulletPref:{default:null,type:cc.Prefab},bulletList:[cc.Prefab]},start:function(){},setAngle:function(e){this.bulletAngle=e},addBullet:function(e,t,i){var n=cc.instantiate(this.bulletPref),o=480+t,s=i;n.getComponent("bullet").sendBullet(o,s),this.type=e,this.node.addChild(n),this.bulletList.push(n)},update:function(e){var t=this,i=0;t.bulletList.forEach(function(e){var n=e.getComponent(cc.Sprite);if(0==cc.isValid(n))return t.node.removeChild(e),void t.bulletList.splice(i,1);i++})}}),cc._RF.pop()},{}],bullet:[function(e,t,i){"use strict";cc._RF.push(t,"f1650yoD0dMDoWiEFxcpNRU","bullet"),cc.Class({extends:cc.Component,properties:{mousePosX:0,mousePosY:0,bulletType:0,isDelete:!1},start:function(){},sendBullet:function(e,t){cc.view.getDesignResolutionSize();var i=this.node.x-e,n=this.node.y-t;this.mousePosX=e,this.mousePosY=t;var o=Math.sqrt(i*i+n*n),s=cc.find("Canvas").getComponent("tower").getBulletAngle();this.node.setRotation(s);var c=cc.moveTo(o/200,cc.v2(e,t)),r=cc.callFunc(this.removeSprite,this),h=cc.callFunc(this.puttingNet,this),a=cc.sequence(c,r,h);this.node.runAction(a)},setType:function(e){this.bulletType=e},removeSprite:function(){var e=this.getComponent(cc.Sprite);0!=cc.isValid(e)&&(e.destroy(),this.isDelete=!0)},puttingNet:function(){cc.find("netMgr").getComponent("netMgr").addNet(this.mousePosX,this.mousePosY)}}),cc._RF.pop()},{}],fishMgr:[function(e,t,i){"use strict";cc._RF.push(t,"2df64XoxppKAYyYbHcJjeXv","fishMgr"),cc.Class({extends:cc.Component,properties:{flyPrefab:{default:null,type:cc.Prefab},fishindex:0,fishCount:0,fishMaxCount:0,fishList:[cc.Prefab]},start:function(){this.schedule(this.fishWaveCount,5),this.schedule(this.seaHorse,.5),this.schedule(this.bigFish,15),this.schedule(this.rareFish,20)},rareFish:function(){this.fishindex=10,this.addfish()},bigFish:function(){this.fishindex=6,this.addfish()},seaHorse:function(){for(this.fishindex=7,this.fishMaxCount=5;this.fishCount<this.fishMaxCount;)this.addfish(),this.fishCount++},fishWaveCount:function(){var e=0;e<10&&(this.scheduleOnce(this.addfishWave,.2),e++)},addfishWave:function(){for(var e=0;e<10;e++)this.fishWave()},fishWave:function(){var e=cc.instantiate(this.flyPrefab);this.node.addChild(e),this.fishList.push(e);cc.view.getDesignResolutionSize();this.fishindex=1;var t=e.addComponent(cc.BoxCollider);t.tag=this.fishindex,t.size.width/=2,t.size.height/=4,e.x=0,e.y=50*(parseInt(5*Math.random())+1)+250;var i=e.getComponent(cc.Animation),n="fish_"+this.fishindex;i.play(n);var o=e.addComponent("fish");o.setfishType(this.fishindex),o.setfishPos(e.x,e.y)},addfish:function(){var e=cc.instantiate(this.flyPrefab);this.node.addChild(e),this.fishList.push(e);var t=cc.view.getDesignResolutionSize(),i=e.addComponent(cc.BoxCollider);switch(i.tag=this.fishindex,this.fishindex){case 6:e.x=parseInt(Math.random()*parseInt(t.width)),e.y=t.height+200,i.size.width/=.5,i.size.height/=.5;break;case 7:e.x=parseInt(Math.random()*parseInt(t.width)),e.y=-200,i.size.width/=2,i.size.height/=2;break;case 10:e.x=t.width+200,e.y=parseInt(Math.random()*parseInt(t.height)),i.size.width/=.2,i.size.height/=.5}var n=e.getComponent(cc.Animation),o="fish_"+this.fishindex;n.play(o);var s=e.addComponent("fish");s.setfishType(this.fishindex),s.setfishPos(e.x,e.y)},setFishNumberCount:function(){this.fishCount--,cc.log("fishCount--",this.fishCount)}}),cc._RF.pop()},{}],fish:[function(e,t,i){"use strict";cc._RF.push(t,"8b450HIiXJG+Yv/XvCYSy/I","fish"),cc.Class({extends:cc.Component,properties:{hp:0,FishType:0,FishPosX:0,FishPosY:0,FishMoney:0,FishScore:0,isDeath:!1},start:function(){switch(this.FishType){case 1:this.littleFishMove();break;case 5:this.schedule(this.normalFishMove,4.5);break;case 6:this.schedule(this.bigFishMove,7);break;case 7:this.schedule(this.normalFishMove,2.5);break;case 10:this.schedule(this.rareFishMove,7)}},bigFishMove:function(){if(!this.isDeath){this.hp=20,this.FishMoney=50,this.FishScore=2*this.FishMoney;var e=cc.view.getDesignResolutionSize(),t=new cc.Node;t.x=Math.random()*parseInt(e.width),t.y=-200;var i=this.node.x-t.x,n=this.node.y-t.y;cc.find("Canvas");this.node.setRotation(90);var o=Math.sqrt(i*i+n*n),s=cc.moveTo(o/50,cc.v2(t.x,t.y)),c=cc.callFunc(this.removeFishWave,this),r=cc.sequence(s,c);this.node.runAction(r)}},normalFishMove:function(){if(!this.isDeath){this.hp=10,this.FishMoney=20,this.FishScore=2*this.FishMoney;var e=cc.view.getDesignResolutionSize(),t=new cc.Node;t.x=Math.random()*parseInt(e.width),t.y=Math.random()*parseInt(e.height);var i=this.node.x-t.x,n=this.node.y-t.y;if(i>0){var o=cc.flipX(!0);this.node.runAction(o)}else{var s=cc.flipX(!1);this.node.runAction(s)}if(5==this.FishType){var c=cc.find("Canvas").getComponent("tower").getAngle(t,this.node);cc.log(c);var r=cc.rotateTo(5,c);this.node.runAction(r)}var h=Math.sqrt(i*i+n*n),a=cc.moveTo(h/50,cc.v2(t.x,t.y)),u=cc.callFunc(this.move,this),l=cc.sequence(a,u);this.node.runAction(l)}},littleFishMove:function(){if(!this.isDeath){this.hp=4,this.FishMoney=1,this.FishScore=2*this.FishMoney;var e=cc.view.getDesignResolutionSize().width+100,t=this.FishPosY,i=cc.moveTo(10,cc.v2(e,t)),n=cc.callFunc(this.removeFishWave,this),o=cc.sequence(i,n);this.node.runAction(o)}},rareFishMove:function(){if(!this.isDeath&&!this.isExist){this.hp=50,this.FishMoney=200,this.FishScore=2*this.FishMoney;var e=cc.view.getDesignResolutionSize(),t=new cc.Node;t.x=-200,t.y=Math.random()*parseInt(e.height);var i=this.node.x-t.x,n=this.node.y-t.y;cc.find("Canvas");this.node.setRotation(180);var o=Math.sqrt(i*i+n*n),s=cc.moveTo(o/50,cc.v2(t.x,t.y)),c=cc.callFunc(this.removeFishWave,this),r=cc.sequence(s,c);this.node.runAction(r)}},setfishType:function(e){this.FishType=e},setfishPos:function(e,t){this.FishPosX=e,this.FishPosY=t},onCollisionEnter:function(e,t){if(0==e.tag&&0==e.node.getComponent("net").netType){var i=cc.find("Canvas").getComponent("tower").getDamage();this.hp-=i+1,0==this.hp&&this.fishDeathAni()}},removeFish:function(){var e=this.getComponent(cc.Sprite),t=this.getComponent(cc.Animation);if(cc.find("moneyMgr").getComponent("moneyMgr").addMoney(e.node.x,e.node.y),this.node.removeComponent(cc.BoxCollider),0!=cc.isValid(e)){t.destroy(),e.destroy(),this.isDeath=!0,this.isExist=!1;var i=cc.find("Canvas").getComponent("tower");i.setfishMoney(this.FishMoney),i.setfishScore(this.FishScore),i.curGameMoneyIncrease(),i.curGameScoreIncrease(),i.moneySet(),i.scoreSet();var n=cc.find("fishMgr").getComponent("fishMgr");7!=this.FishType&&6!=this.FishType&&5!=this.FishType||n.setFishNumberCount()}},fishDeathAni:function(){this.node.stopAllActions(),this.scheduleOnce(this.removeFish,1)},removeFishWave:function(){var e=this.getComponent(cc.Sprite),t=this.getComponent(cc.Animation);this.node.removeComponent(cc.BoxCollider),0!=cc.isValid(e)&&(t.destroy(),e.destroy(),this.isDeath=!0)}}),cc._RF.pop()},{}],loadmenu:[function(e,t,i){"use strict";cc._RF.push(t,"d8365BfwXRJRIuJd2E/RwGa","loadmenu"),cc.Class({extends:cc.Component,properties:{},start:function(){cc.director.preloadScene("menu",function(){cc.log("menu preloaded OK\uff01")}),this.scheduleOnce(this.loadMenu,1.2)},loadMenu:function(){cc.director.loadScene("menu")}}),cc._RF.pop()},{}],menulogo:[function(e,t,i){"use strict";cc._RF.push(t,"feb75LmaI5JBrf+qZJ5PgkV","menulogo"),cc.Class({extends:cc.Component,properties:{},start:function(){var e=cc.scaleTo(2,.7,.7);this.node.runAction(e)},loadGame:function(){this.node.on(cc.Node.EventType.TOUCH_END,function(e){cc.director.loadScene("game")})}}),cc._RF.pop()},{}],moneyMgr:[function(e,t,i){"use strict";cc._RF.push(t,"dc639W+6TZEX6zDLZATApPw","moneyMgr"),cc.Class({extends:cc.Component,properties:{money:{default:null,type:cc.Prefab},moneyList:[cc.Prefab]},start:function(){},addMoney:function(e,t){var i=cc.instantiate(this.money);i.x=e,i.y=t,this.node.addChild(i),this.moneyList.push(i)},update:function(e){var t=this,i=0;t.moneyList.forEach(function(e){var n=e.getComponent(cc.Sprite);if(0==cc.isValid(n))return t.node.removeChild(e),void t.moneyList.splice(i,1);i++})}}),cc._RF.pop()},{}],money:[function(e,t,i){"use strict";cc._RF.push(t,"983f1N+7j9MtK3mX6g2oC2r","money"),cc.Class({extends:cc.Component,properties:{isDelete:!1,money:{type:cc.AudioSource,default:null}},start:function(){cc.view.getDesignResolutionSize();var e=cc.find("curMoney").getComponent(cc.Label),t=this.node.x-e.node.x,i=this.node.y-e.node.y;this.getComponent(cc.Animation).play("money");var n=Math.sqrt(t*t+i*i),o=cc.moveTo(n/250,cc.v2(e.node.x,e.node.y)),s=cc.callFunc(this.removeMoney,this),c=cc.sequence(o,s);this.node.runAction(c)},removeMoney:function(){var e=this.getComponent(cc.Animation);this.getComponent(cc.Sprite).destroy(),this.isDelete=!0,e.destroy()}}),cc._RF.pop()},{}],netMgr:[function(e,t,i){"use strict";cc._RF.push(t,"7433dWnCZZESqMRI+t7CIdU","netMgr"),cc.Class({extends:cc.Component,properties:{net:{default:null,type:cc.Prefab},netList:[cc.Prefab]},start:function(){},addNet:function(e,t){var i=cc.instantiate(this.net);i.x=e,i.y=t,this.node.addChild(i),this.netList.push(i)},update:function(e){var t=this,i=0;t.netList.forEach(function(e){var n=e.getComponent(cc.Sprite);if(0==cc.isValid(n))return t.node.removeChild(e),void t.netList.splice(i,1);i++})}}),cc._RF.pop()},{}],net:[function(e,t,i){"use strict";cc._RF.push(t,"0849348bv1Mj711CKHxCXq8","net"),cc.Class({extends:cc.Component,properties:{netType:0,netDamage:1,isDelete:!1,net:{type:cc.AudioSource,default:null}},start:function(){this.scheduleOnce(this.removeBomb,1)},removeBomb:function(){this.getComponent(cc.Sprite).destroy(),this.isDelete=!0},onCollisionEnter:function(e,t){2==e.tag&&cc.Log("\u6478\u9c7c")},onCollisionStay:function(e,t){},onCollisionExit:function(e,t){}}),cc._RF.pop()},{}],towerMgr:[function(e,t,i){"use strict";cc._RF.push(t,"11df31j1L5Fv4FLKR6vqQYX","towerMgr"),cc.Class({extends:cc.Component,properties:{towerType:0,button:{type:cc.AudioSource,default:null}},start:function(){},leftButton:function(){0==this.towerType?this.towerType=4:this.towerType--,this.getComponent(cc.AudioSource).play(),cc.log("this.towerType+",this.towerType);var e=cc.find("ui_box_2/towerMgr/base/tower").getComponent(cc.Sprite),t="GameElement/GameElement/cannon/"+this.towerType;cc.log(t),cc.loader.loadRes(t,cc.SpriteFrame,function(t,i){cc.log("spriteFrame",i),e.spriteFrame=i}),this.setDamage()},RightButton:function(){4==this.towerType?this.towerType=0:this.towerType++,this.getComponent(cc.AudioSource).play(),cc.log("this.towerType-",this.towerType);var e=cc.find("ui_box_2/towerMgr/base/tower").getComponent(cc.Sprite),t="GameElement/GameElement/cannon/"+this.towerType;cc.loader.loadRes(t,cc.SpriteFrame,function(t,i){cc.log("spriteFrame",i),e.spriteFrame=i}),this.setDamage()},setDamage:function(){cc.find("Canvas").getComponent("tower").setTowerType(this.towerType)}}),cc._RF.pop()},{}],tower:[function(e,t,i){"use strict";cc._RF.push(t,"0180ajsnupOQ4xQ7zM3FttO","tower"),cc.Class({extends:cc.Component,properties:{bAngle:0,towerType:0,FishMoney:0,FishScore:0,arrow:{default:null,type:cc.Sprite},x:{type:cc.AudioSource,default:null},isEnoughMoney:!0,curGameMoney:300,curGameScore:0},start:function(){var e=this;cc.director.getCollisionManager().enabled=!0,cc.director.getCollisionManager().enabledDebugDraw=!1,e.node.on(cc.Node.EventType.TOUCH_END,function(t){var i=cc.view.getDesignResolutionSize(),n=t.getLocation();n.x-=i.width/2+20,n.y-=0;var o=e.getAngle(n,e.arrow.node.getPosition());(e.bAngle=o,e.arrow.node.setRotation(o),e.curGameMoney>=2*(e.towerType+1))&&(e.curGameMoney-=2*(e.towerType+1),e.moneySet(),e.getComponent(cc.AudioSource).play(),cc.find("bulletMgr").getComponent("bulletMgr").addBullet(0,n.x,n.y))})},getBulletAngle:function(){return this.bAngle},sendBullet:function(){var e=cc.find("bulletMgr");null!=e?e.getComponent("bulletMgr").addBullet(0,this.node.x+40,0):cc.log("bulletMgr null!!")},getAngle:function(e,t){var i=t.y-e.y,n=t.x-e.x,o=Math.abs(i)/Math.abs(n),s=0;return i>0&&n<0?s=180*Math.atan(o)/Math.PI-90:i>0&&n>0?s=90-180*Math.atan(o)/Math.PI:i<0&&n<0?s=180*-Math.atan(o)/Math.PI-90:i<0&&n>0&&(s=180*Math.atan(o)/Math.PI+90),(s+=180)>90&&s<180?s=90:s<270&&s>180&&(s=270),s},curGameMoneyIncrease:function(){this.curGameMoney+=this.FishMoney},curGameScoreIncrease:function(){this.curGameScore+=this.FishScore},moneySet:function(){cc.find("curMoney").getComponent(cc.Label).string=this.curGameMoney},scoreSet:function(){cc.find("curScore").getComponent(cc.Label).string=this.curGameScore},setfishMoney:function(e){this.FishMoney=e},setfishScore:function(e){this.FishScore=e},Moneyset:function(){this.curGameMoney=300},setTowerType:function(e){this.towerType=e},getDamage:function(){return this.towerType}}),cc._RF.pop()},{}]},{},["LevelBG","backMenu","bullet","bulletMgr","fish","fishMgr","loadmenu","menulogo","money","moneyMgr","net","netMgr","tower","towerMgr"]);